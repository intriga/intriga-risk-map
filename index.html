<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Intriga Risk Map (OWASP) - Gesti칩n Completa</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Interruptor de tema -->
    <div class="theme-switch">
        <div class="theme-switch-btn" id="theme-toggle">
            <span class="theme-icon">游깿</span>
        </div>
    </div>

    <div class="container py-4">
        <header class="text-center mb-4">
            <h1 class="display-5">OWASP Risk Assessment Calculator</h1>
            <p class="lead">Calculadora de evaluaci칩n de riesgos con gesti칩n completa de vulnerabilidades</p>
        </header>

        <!-- Pesta침as principales -->
        <ul class="nav nav-tabs" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="calculator-tab" data-bs-toggle="tab" data-bs-target="#calculator" type="button" role="tab">Calculadora</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="vulnerabilities-tab" data-bs-toggle="tab" data-bs-target="#vulnerabilities" type="button" role="tab">Vulnerabilidades Guardadas</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab">Dashboard</button>
            </li>
        </ul>

        <div class="tab-content" id="mainTabsContent">
            <!-- Pesta침a de Calculadora -->
            <div class="tab-pane fade show active" id="calculator" role="tabpanel">
                <div class="row">
                    <!-- Informaci칩n General de la Vulnerabilidad -->
                    <section class="col-12">
                        <h5 class="border-bottom">Informaci칩n General de la Vulnerabilidad</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Nombre de la Vulnerabilidad</label>
                                <input type="text" class="form-control" id="vulnerability-name" placeholder="Ej: Exposici칩n de directorios">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">OWASP 2021</label>
                                <select class="form-control" id="owasp-category">
                                    <option value="">Seleccione categor칤a OWASP</option>
                                    <option value="A01:2021">A01:2021 - Broken Access Control</option>
                                    <option value="A02:2021">A02:2021 - Cryptographic Failures</option>
                                    <option value="A03:2021">A03:2021 - Injection</option>
                                    <option value="A04:2021">A04:2021 - Insecure Design</option>
                                    <option value="A05:2021">A05:2021 - Security Misconfiguration</option>
                                    <option value="A06:2021">A06:2021 - Vulnerable Components</option>
                                    <option value="A07:2021">A07:2021 - Authentication Failures</option>
                                    <option value="A08:2021">A08:2021 - Software Integrity Failures</option>
                                    <option value="A09:2021">A09:2021 - Security Logging Failures</option>
                                    <option value="A10:2021">A10:2021 - Server-Side Request Forgery</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">MITRE ID</label>
                                <input type="text" class="form-control" id="mitre-id" placeholder="Ej: T1160">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Criticidad seg칰n Herramienta</label>
                                <input type="text" class="form-control" id="tool-criticity" placeholder="Ej: Alto, Medio, Bajo">
                            </div>
                        </div>
                    </section>

                    <!-- Campos Adicionales -->
                    <section class="col-12 additional-fields">
                        <h5 class="border-bottom">Informaci칩n Adicional de la Vulnerabilidad</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Agente de Amenazas</label>
                                <input type="text" class="form-control" id="threat-agent" placeholder="Ej: Agente externo">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Vector de Ataque</label>
                                <input type="text" class="form-control" id="attack-vector" placeholder="Describa el vector de ataque">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 mb-3">
                                <label class="form-label">Debilidad de Seguridad</label>
                                <textarea class="form-control" id="security-weakness" rows="3" placeholder="Describa la debilidad de seguridad"></textarea>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 mb-3">
                                <label class="form-label">Controles de Seguridad</label>
                                <textarea class="form-control" id="security-controls" rows="2" placeholder="Describa los controles de seguridad"></textarea>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 mb-3">
                                <label class="form-label">Impacto T칠cnico - Negocio</label>
                                <textarea class="form-control" id="technical-business-impact" rows="2" placeholder="Describa el impacto t칠cnico y de negocio"></textarea>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 mb-3">
                                <label class="form-label">Detalle</label>
                                <textarea class="form-control" id="detail" rows="3" placeholder="Detalles adicionales"></textarea>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 mb-3">
                                <label class="form-label">Descripci칩n</label>
                                <textarea class="form-control" id="description" rows="3" placeholder="Descripci칩n completa"></textarea>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 mb-3">
                                <label class="form-label">Recomendaci칩n</label>
                                <textarea class="form-control" id="recommendation" rows="3" placeholder="Recomendaciones para mitigar"></textarea>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 mb-3">
                                <label class="form-label">Estrategia de Detecci칩n MITRE</label>
                                <textarea class="form-control" id="mitre-detection" rows="2" placeholder="Estrategias de detecci칩n"></textarea>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <label class="form-label">Estrategia de Mitigaci칩n MITRE</label>
                                <textarea class="form-control" id="mitre-mitigation" rows="2" placeholder="Estrategias de mitigaci칩n"></textarea>
                            </div>
                        </div>
                    </section>

                    <!-- Factores del Agente de Amenaza -->
                    <section class="col-md-6">
                        <h5 class="border-bottom" title="The first set of factors are related to the threat agent involved. The goal here is to estimate the likelihood of a successful attack by this group of threat agents. Use the worst-case threat agent.">Factores del Agente de Amenaza</h5>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How technically skilled is this group of threat agents?">Nivel de habilidad</div>
                            <div class="col-8">
                                <select class="form-control" id="sl" name="sl">
                                    <option value="1">Sin habilidades t칠cnicas (1)</option>
                                    <option value="3">Algunas habilidades t칠cnicas (3)</option>
                                    <option value="5">Usuario avanzado de computadora (5)</option>
                                    <option value="6">Habilidades de red y programaci칩n (6)</option>
                                    <option value="9">Habilidades de penetraci칩n de seguridad (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How motivated is this group of threat agents to find and exploit this vulnerability?">Motivo</div>
                            <div class="col-8">
                                <select class="form-control" id="m" name="m">
                                    <option value="1">Baja o ninguna recompensa (1)</option>
                                    <option value="4">Posible recompensa (4)</option>
                                    <option value="9">Alta recompensa (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="What resources and opportunities are required for this group of threat agents to find and exploit this vulnerability?">Oportunidad</div>
                            <div class="col-8">
                                <select class="form-control" id="o" name="o">
                                    <option value="0">Acceso completo o recursos costosos requeridos (0)</option>
                                    <option value="4">Acceso especial o recursos requeridos (4)</option>
                                    <option value="7">Alg칰n acceso o recursos requeridos (7)</option>
                                    <option value="9">Sin acceso o recursos requeridos (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How large is this group of threat agents?">Tama침o</div>
                            <div class="col-8">
                                <select class="form-control" id="s" name="s">
                                    <option value="2">Desarrolladores, administradores de sistemas (2)</option>
                                    <option value="4">Usuarios de intranet (4)</option>
                                    <option value="5">Socios (5)</option>
                                    <option value="6">Usuarios autenticados (6)</option>
                                    <option value="9">Usuarios an칩nimos de Internet (9)</option>
                                </select>
                            </div>
                        </div>
                    </section>

                    <!-- Factores de Impacto T칠cnico -->
                    <section class="col-md-6">
                        <h5 class="border-bottom" title="Technical impact can be broken down into factors aligned with the traditional security areas of concern: confidentiality, integrity, availability, and accountability. The goal is to estimate the magnitude of the impact on the system if the vulnerability were to be exploited.">Factores de Impacto T칠cnico</h5>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How much data could be disclosed and how sensitive is it?">P칠rdida de confidencialidad</div>
                            <div class="col-8">
                                <select class="form-control" id="lc" name="lc">
                                    <option value="2">Datos no sensibles m칤nimos divulgados (2)</option>
                                    <option value="6">Datos cr칤ticos m칤nimos divulgados (6)</option>
                                    <option value="6">Datos no sensibles extensos divulgados (6)</option>
                                    <option value="7">Datos cr칤ticos extensos divulgados (7)</option>
                                    <option value="9">Todos los datos divulgados (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How much data could be corrupted and how damaged is it?">P칠rdida de integridad</div>
                            <div class="col-8">
                                <select class="form-control" id="li" name="li">
                                    <option value="1">Datos m칤nimamente corruptos (1)</option>
                                    <option value="3">Datos m칤nimamente muy corruptos (3)</option>
                                    <option value="5">Datos extensamente corruptos (5)</option>
                                    <option value="7">Datos extensamente muy corruptos (7)</option>
                                    <option value="9">Todos los datos totalmente corruptos (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How much service could be lost and how vital is it?">P칠rdida de disponibilidad</div>
                            <div class="col-8">
                                <select class="form-control" id="lav" name="lav">
                                    <option value="1">Servicios secundarios m칤nimos interrumpidos (1)</option>
                                    <option value="5">Servicios primarios m칤nimos interrumpidos (5)</option>
                                    <option value="5">Servicios secundarios extensos interrumpidos (5)</option>
                                    <option value="7">Servicios primarios extensos interrumpidos (7)</option>
                                    <option value="9">Todos los servicios completamente perdidos (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="Are the threat agents' actions traceable to an individual?">P칠rdida de responsabilidad</div>
                            <div class="col-8">
                                <select class="form-control" id="lac" name="lac">
                                    <option value="1">Completamente rastreable (1)</option>
                                    <option value="7">Posiblemente rastreable (7)</option>
                                    <option value="9">Completamente an칩nimo (9)</option>
                                </select>
                            </div>
                        </div>
                    </section>

                    <!-- Factores de Vulnerabilidad -->
                    <section class="col-md-6">
                        <h5 class="border-bottom" title="The next set of factors are related to the vulnerability involved. The goal here is to estimate the likelihood of the particular vulnerability involved being discovered and exploited. Assume the threat agent selected above.">Factores de Vulnerabilidad</h5>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How easy is it for this group of threat agents to discover this vulnerability?">Facilidad de descubrimiento</div>
                            <div class="col-8">
                                <select class="form-control" id="ed" name="ed">
                                    <option value="1">Pr치cticamente imposible (1)</option>
                                    <option value="3">Dif칤cil (3)</option>
                                    <option value="7">F치cil (7)</option>
                                    <option value="9">Herramientas automatizadas disponibles (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How easy is it for this group of threat agents to actually exploit this vulnerability?">Facilidad de explotaci칩n</div>
                            <div class="col-8">
                                <select class="form-control" id="ee" name="ee">
                                    <option value="1">Te칩rico (1)</option>
                                    <option value="3">Dif칤cil (3)</option>
                                    <option value="5">F치cil (5)</option>
                                    <option value="9">Herramientas automatizadas disponibles (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How well known is this vulnerability to this group of threat agents?">Conocimiento</div>
                            <div class="col-8">
                                <select class="form-control" id="a" name="a">
                                    <option value="1">Desconocido (1)</option>
                                    <option value="4">Oculto (4)</option>
                                    <option value="6">Obvio (6)</option>
                                    <option value="9">Conocimiento p칰blico (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How likely is an exploit to be detected?">Detecci칩n de intrusiones</div>
                            <div class="col-8">
                                <select class="form-control" id="id" name="id">
                                    <option value="1">Detecci칩n activa en la aplicaci칩n (1)</option>
                                    <option value="3">Registrado y revisado (3)</option>
                                    <option value="8">Registrado sin revisi칩n (8)</option>
                                    <option value="9">No registrado (9)</option>
                                </select>
                            </div>
                        </div>
                    </section>

                    <!-- Factores de Impacto de Negocio -->
                    <section class="col-md-6">
                        <h5 class="border-bottom" title="The business impact stems from the technical impact, but requires a deep understanding of what is important to the company running the application. In general, you should be aiming to support your risks with business impact, particularly if your audience is executive level. The business risk is what justifies investment in fixing security problems.">Factores de Impacto de Negocio</h5>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How much financial damage will result from an exploit?">Da침o financiero</div>
                            <div class="col-8">
                                <select class="form-control" id="fd" name="fd">
                                    <option value="1">Menos que el costo de arreglar la vulnerabilidad (1)</option>
                                    <option value="3">Efecto menor en las ganancias anuales (3)</option>
                                    <option value="7">Efecto significativo en las ganancias anuales (7)</option>
                                    <option value="9">Bancarrota (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="Would an exploit result in reputation damage that would harm the business?">Da침o a la reputaci칩n</div>
                            <div class="col-8">
                                <select class="form-control" id="rd" name="rd">
                                    <option value="1">Da침o m칤nimo (1)</option>
                                    <option value="4">P칠rdida de cuentas principales (4)</option>
                                    <option value="5">P칠rdida de buena voluntad (5)</option>
                                    <option value="9">Da침o a la marca (9)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How much exposure does non-compliance introduce?">Incumplimiento</div>
                            <div class="col-8">
                                <select class="form-control" id="nc" name="nc">
                                    <option value="2">Violaci칩n menor (2)</option>
                                    <option value="5">Violaci칩n clara (5)</option>
                                    <option value="7">Violaci칩n de alto perfil (7)</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="h6 nomargin col-4 d-flex align-items-center" title="How much personally identifiable information could be disclosed?">Violaci칩n de privacidad</div>
                            <div class="col-8">
                                <select class="form-control" id="pv" name="pv">
                                    <option value="3">Un individuo (3)</option>
                                    <option value="5">Cientos de personas (5)</option>
                                    <option value="7">Miles de personas (7)</option>
                                    <option value="9">Millones de personas (9)</option>
                                </select>
                            </div>
                        </div>
                    </section>

                    <!-- Resultados y Gr치fico -->
                    <section class="col-12">
                        <div class="row">
                            <div class="col-md-6">
                                <h5 class="border-bottom">Puntuaci칩n de Probabilidad</h5>
                                <h4 class="LS text-center">0</h4>
                            </div>
                            <div class="col-md-6">
                                <h5 class="border-bottom">Puntuaci칩n de Impacto</h5>
                                <h4 class="IS text-center">0</h4>
                            </div>
                        </div>
                        
                        <div class="risk-chart-container">
                            <canvas id="riskChart"></canvas>
                        </div>
                        
                        <div id="risk-result" class="risk-indicator">
                            Riesgo: No calculado
                        </div>
                        
                        <div class="text-center mt-4">
                            <button class="btn btn-primary btn-lg" id="calculate-btn">Calcular Riesgo</button>
                            <button class="btn btn-success btn-lg" id="save-btn">Guardar Vulnerabilidad</button>
                        </div>
                    </section>
                </div>
            </div>

            <!-- Pesta침a de Vulnerabilidades Guardadas -->
            <div class="tab-pane fade" id="vulnerabilities" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4>Vulnerabilidades Guardadas</h4>
                    <span class="badge bg-primary" id="vulnerability-count">0 vulnerabilidades</span>
                </div>
                
                <div id="vulnerabilities-list">
                    <!-- Las vulnerabilidades se cargar치n aqu칤 -->
                </div>
            </div>

            <!-- Pesta침a de Dashboard -->
            <div class="tab-pane fade" id="dashboard" role="tabpanel">
                <h4 class="mb-4">Dashboard de Vulnerabilidades</h4>
                
                <div class="summary mb-4">
                    <div class="summary-item total">
                        <div>Total Vulnerabilidades</div>
                        <div class="summary-count" id="total-vulnerabilities">0</div>
                    </div>
                    <div class="summary-item">
                        <div>Cr칤ticas</div>
                        <div class="summary-count" id="critical-count">0</div>
                    </div>
                    <div class="summary-item">
                        <div>Altas</div>
                        <div class="summary-count" id="high-count">0</div>
                    </div>
                    <div class="summary-item">
                        <div>Medias</div>
                        <div class="summary-count" id="medium-count">0</div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">Distribuci칩n por Nivel de Riesgo</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="riskDistributionChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">Distribuci칩n por Categor칤a OWASP</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="owaspDistributionChart"></canvas>
                                </div>
                                <div class="legend" id="chart-legend">
                                    <!-- La leyenda se generar치 din치micamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-4">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">Vulnerabilidades por Categor칤a OWASP</h5>
                        <button class="btn btn-success btn-sm" id="export-all-btn">
                            游늯 Exportar a Word
                        </button>
                    </div>
                    <div class="card-body">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Categor칤a OWASP</th>
                                    <th>Descripci칩n</th>
                                    <th>URL/Dominio</th>
                                    <th>Nivel de Riesgo</th>
                                </tr>
                            </thead>
                            <tbody id="dashboard-vulnerabilities-list">
                                <!-- Las vulnerabilidades se agregar치n aqu칤 din치micamente -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para ver detalles -->
    <div class="modal fade" id="vulnerabilityModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalles de Vulnerabilidad</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="modal-body">
                    <!-- Los detalles se cargar치n aqu칤 -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="main.js"></script>
</body>
</html>